<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Main Page</title>
    <link rel="stylesheet" href="./css/init.css" />
    <link rel="stylesheet" href="./css/cart.css" />
    <script type="text/javascript" src="./js/jquery-2.1.1.min.js">S</script>
    <script type="text/javascript" src="./js/jquery.easing.1.3.js"></script>
    <script type="text/javascript" src="./js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="./js/prefixfree.min.js"></script>
    <script src="./js/cart.js"></script>
    <!-- 
        정규표현식 ▼

        숫자 타입값에 콤마(,) 추가하기 
        https://webisfree.com/2016-08-29/[자바스크립트]-숫자-타입값에-콤마-추가하는-방법
    -->
    <script>
        
        // addComma() : 숫자 타입값을 매개변수로 받아 콤마를 추가하여 문자열로 반환해주는 함수
        function addComma(num) {
            var regexp = /\B(?=(\d{3})+(?!\d))/g;
            return num.toString().replace(regexp, ',');
        }

        $(function () {

            console.log(typeof $('span.price').text());
            // 판매가,할인가,합계를 addComma() 함수 사용하여 최초입력
            $('span.price').each(function () {
                $(this).text(addComma($(this).text()));
            });

            // 장바구니 [수량] 변경 시, 1보다 작은 값을 입력하면 alert(알림창)
            $('.inputNumber').on("change keyup paste", function () {
                var value = $(this).val();
                if (window.event.keyCode == 13 && value != "") {
                    $('.amtModify').click();
                    $('.inputNumber').blur();
                } else if (value < 1 && value != "") {
                    alert("최소 구매수량은 1개입니다.");
                    $(this).val("1").focus();
                } else if (window.event.keyCode == 13 && value == "") {
                    alert("최소 구매수량은 1개입니다.");
                    $(this).val("1").focus();
                }
            });


            // 장바구니 [수량] 공백일 때, alert(알림창)
            $('.inputNumber').blur(function () {
                var value = $(this).val();
                if (value == "") {
                    alert("최소 구매수량은 1개입니다.");
                    $(this).val("1").focus();
                }
            });

            // [수정] 버튼 클릭 시, alert(알림창)
            $('.amtModify').click(function () {
                var price = Number($('span.price:eq(1)').text().replace(",", ""));
                var aftPrice = price * $('.inputNumber').val();
                var amountSpan = $('span.price:eq(2)');
                amountSpan.text(addComma(aftPrice));
                alert("변경되었습니다.");
            });

            // [삭제] 버튼 클릭 시
            $('.deleteBtn').click(function () {
                var row = $(this).parent().parent();
                if (confirm("삭제하시겠습니까?"))
                    row.remove();
            });

            // [결제하기] 버튼 클릭 시
            $('.pay').click(function () {
                var length = $('#table tr').length;
                console.log(length);
                if (length > 1) {
                    if (confirm("주문결제 페이지로 이동하시겠습니까?"))
                        location.href = "order.html";
                } else
                    alert("장바구니에 상품이 없습니다.");
            });
        });

    </script>
</head>

<body>
    <!--main_header_wrap-->
    <div id="main_header_wrap">
        <!--main_header-->
        <header id="main_header">

            <!--main_logo-->
            <div id="main_logo">
                <a href="#"><img src="http://placehold.it/150x70" alt="iriver" /></a>
            </div>
            <!--//main_logo-->

            <!--main_gnb-->
            <div id="main_gnb">
                <ul class="list">
                    <li class="item_0">
                        <a href="#">
                            <p>시험안내</p>
                        </a>
                    </li>
                    <li class="item_1">
                        <a href="#">
                            <p>교재구매</p>
                        </a>
                        <ul class="list hover">
                            <a href="./index.html">
                                <li class="item_0">구매목록</li>
                            </a>
                            <a href="#">
                                <li class="item_1">장바구니</li>
                            </a>
                        </ul>
                    </li>
                    <li class="item_2">
                        <a href="#">
                            <p>문제유형</p>
                        </a>
                    </li>
                    <li class="item_3">
                        <a href="#">
                            <p>커뮤니티</p>
                        </a>
                        <ul class="list hover">
                            <a href="#">
                                <li class="item_0">공지사항</li>
                            </a>
                            <a href="#">
                                <li class="item_1">자유 게시판</li>
                            </a>
                            <a href="#">
                                <li class="item_2">질문 게시판</li>
                            </a>
                        </ul>
                    </li>
                    <li class="item_4">
                        <a href="#">
                            <p>고객센터</p>
                        </a>
                        <ul class="list hover">
                            <a href="#">
                                <li class="item_0">Q&A</li>
                            </a>
                            <a href="#">
                                <li class="item_1">개인정보보호정책</li>
                            </a>
                            <a href="#">
                                <li class="item_2">이용약관</li>
                            </a>
                            <a href="#">
                                <li class="item_3">사이트맵</li>
                            </a>
                        </ul>
                    </li>
                </ul>
            </div>
            <!--//main_gnb-->
            <!--top_menu-->
            <div id="top_menu">
                <ul class="list">
                    <a href="#">
                        <li class="item_0">
                            <p>회원가입</p>
                        </li>
                    </a>
                    <a href="#">
                        <li class="item_1">
                            <p>로그인</p>
                        </li>
                    </a>
                    <a href="#">
                        <li class="item_2">
                            <p>FAQ</p>
                        </li>
                    </a>
                    <a href="#">
                        <li class="item_3">
                            <p>사이트맵</p>
                        </li>
                    </a>
                </ul>
            </div>
            <!--//top_menu-->
        </header>
        <!--//main_header-->
    </div>
    <!--//main_header_wrap-->

    <!-- wrap -->
    <div id="wrap">
        <div class="processWrap">
            <p class="process">주문완료&nbsp;</p>
            <p class="process">주문결제 >&nbsp;</p>
            <p class="process">장바구니 >&nbsp;</p>
        </div>
        <!-- lnb -->
        <div class="lnb">
            <div>
                <img class="top" src="./images/untitled.png" />
                <ul>
                    <a href="./index.html">
                        <li>구매목록</li>
                    </a>
                    <a href="#">
                        <li style="color:rgb(38, 130, 187);">장바구니</li>
                    </a>
                </ul>
                <img class="bottom" src="./images/left_t08.gif" />
            </div>
        </div>
        <!-- //lnb -->

        <!-- orderSheet -->
        <h2 id="orderSheet">주문서</h2>
        <!-- //orderSheet -->

        <!-- innerWrap -->
        <div id="innerWrap">
            <!-- table -->
            <table id="table" border="1px" cellspacing="0">
                <tr>
                    <th>상품명</th>
                    <th>판매가</th>
                    <th>할인가</th>
                    <th width="13.8%">수량</th>
                    <th>합계</th>
                    <th>삭제</th>
                </tr>
                <tr>
                    <td>리눅스마스터 1급</td>
                    <td>
                        <span class="price">22000</span>원
                    </td>
                    <td>
                        <span class="price">19000</span>원
                    </td>
                    <td>
                        <input type="number" class="inputNumber" value="1">
                        <img src="./images/icn_modify.gif" class="amtModify" />
                    </td>
                    <td>
                        <span class="price">19000</span>원
                    </td>
                    <td>
                        <span style="color: black;" class="deleteBtn">X</span>
                    </td>
                </tr>
            </table>
            <!-- //table -->
            <a href="#" class="pay button">결제하기</a>
            <a href="#" class="back button" onclick="history.back();">돌아가기</a>
        </div>
        <!-- //innerWrap -->
    </div>
    <!-- //wrap -->

    <!--main_footer-->
    <footer id="main_footer">
        <img src="./images/bottom_long_bar.gif">
        <ul>
            <li><a href="#"><img src="./images/footer_menu_2.gif" /></a></li>
            <li>|</li>
            <li><a href="#"><img src="./images/footer_menu_3.gif" /></a></li>
            <li>|</li>
            <li><a href="#"><img src="./images/footer_menu_4.gif" /></a></li>
            <li>|</li>
            <li><a href="#"><img src="./images/footer_menu_5.gif" /></a></li>
            <li>|</li>
            <li><a href="#"><img src="./images/footer_menu_6.gif" /></a></li>
        </ul>
        <hr />
    </footer>
    <!--//main_footer-->

</body>

</html>